<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Fantasy XIV Weapons</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/project-styles.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" type="image/png" href="/favicon-32x32.png">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-links">
                <a href="/index.html" class="nav-link">Home</a>
                <a href="/index.html" class="nav-link">Projects</a>
                <a href="/index.html" class="nav-link">Contact</a>
            </div>
        </nav>
    </header>

    <main class="project-main">
        <!-- Capa -->
        <section class="project-hero">
            <div class="hero-content">
                <div class="hero-icon">
                    <img src="/img/ffxiv-project.jpg" alt="TCC-project">
                </div>
            </div>
        </section>

        <!-- Detalhes do projeto -->
        <section class="project-info-section">
            <h1>Final Fantasy XIV Weapons - In progress</h1>
            
            <div class="project-meta">
                <div class="meta-item">
                    <span class="tag">Web Scraping</span>
                    <span class="tag">Python</span>
                    <span class="tag">PT-BR</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Date:</span>
                    <span>06/28/2025</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Description:</span>
                    <span>Web scraping project using Python and BeautifulSoup to extract data about the Final Fantasy XIV weapons.</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Repository:</span>
                    <span><a href="https://github.com/juliana-vieira/web-scraping-ffxiv-arms" class="project-link" target="_blank">https://github.com/juliana-vieira/web-scraping-ffxiv-arms</a></span>
                </div>
            </div>
        </section>
        <!-- Introdu√ß√£o -->
            <p class="project-description">
                <p><strong>O Python chegou a Eorzea! üêç</strong></p>
                <p>Nesse projeto, resolvi unir o estudo com o lazer: desenvolvi um script de web scraping utilizando BeautifulSoup e Python para extra√ß√£o de dados de armas do MMORPG Final Fantasy XIV, um dos meus jogos favoritos. Os dados est√£o dispon√≠veis no <a href="https://na.finalfantasyxiv.com/lodestone/playguide/db/item/?category2=1" class="project-link" target="_blank">Eorzea Database</a>.</p>

                <p>Durante meus estudos de Engenharia de Dados, sempre tive d√∫vidas sobre temas de projetos, ainda mais relacionados a extra√ß√£o de dados. Portanto, pensei que seria interessante utilizar dados de fontes que eu conhe√ßo bem e que podem me trazer insights para minha pr√≥pria rotina no jogo.</p>

                <p>Para esse pipeline escolhi a base de armas, o item mais cobi√ßado de qualquer jogo de RPG. Extra√≠ informa√ß√µes essenciais que podem ser utilizadas para ranquear as armas por diversos crit√©rios, como dano, raridade, etc.</p>

                <p><strong>Informa√ß√µes extra√≠das:</strong></p>

                <ul style="padding-left: 20px;">
                    <li>Nome da arma;</li>
                    <li>N√≠vel da arma;</li>
                    <li>N√≠vel m√≠nimo para uso;</li>
                    <li>Classe(s) que pode(m) usar;</li>
                    <li>Tipo da arma (espada, cajado, lan√ßa...)</li>
                    <li>Atributos principais (Strength, Vitality, Mind...);</li>
                    <li>Dano f√≠sico / Auto-ataque / Delay;</li>
                    <li>Raridade (com base na cor do contorno do √≠cone);</li>
                    <li>Fonte do item (ex: vendido por NPC, obtido por coffer, comprado com tomestones...).</li>
                </ul>
                <br>
                <p>Um dos desafios que enfrentei durante o desenvolvimento desse projeto foi relacionado a volumetria de dados. O Eorzea Database possui 5872 itens, separados em 118 p√°ginas. Utilizando apenas la√ßos de repeti√ß√£o, meu pipeline estava com problemas de performance, chegando a demorar mais de 30 minutos para extrair todos os dados.</p>
                <p>Outro ponto a se mencionar √© que o robots.txt do Eorzea Database n√£o determina nenhum bloqueio, o que me permite rodar o script sem delays. Apesar disso, evito rodar o scraping com frequ√™ncia para n√£o sobrecarregar o servidor do Lodestone.</p>
                <p>Diante disso, pesquisei por alternativas e encontrei algumas solu√ß√µes que aumentaram drasticamente a performance do meu script:</p>
                <ul style="padding-left: 20px;">
                    <li><strong>Utiliza√ß√£o de cache com persist√™ncia em disco</strong> para evitar re-scraping desnecess√°rio;</li>
                    <br>
                    <div class="code-container">
                        <div class="code-header">
                            <span>Configura√ß√£o de cache</span>
                            <button class="copy-button" onclick="copyCode()">Copy</button>
                        </div>
                        <div class="code-content" id="codeContent">
                            <div class="line">
                                <span class="line-number">1</span>
                                <span class="line-content"><span class="keyword">try</span>:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">2</span>
                                <span class="line-content">    requests_cache.<span class="function">install_cache</span>(</span>
                            </div>
                            <div class="line">
                                <span class="line-number">3</span>
                                <span class="line-content">        <span class="string">'../ffxiv_cache'</span>, <span class="comment"># Cria um diret√≥rio chamado 'ffxiv_cache'.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">4</span>
                                <span class="line-content">        backend=<span class="string">'filesystem'</span>, <span class="comment"># Armazena o cache no disco.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">5</span>
                                <span class="line-content">        expire_after=NEVER_EXPIRE, <span class="comment"># Cache setado para n√£o expirar.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">6</span>
                                <span class="line-content">        allowable_methods=[<span class="string">'GET'</span>], <span class="comment"># M√©todos permitidos no cache.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">7</span>
                                <span class="line-content">        include_get_headers=<span class="keyword">True</span> <span class="comment"># Considera os cabe√ßalhos da requisi√ß√£o no cache.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">8</span>
                                <span class="line-content">    )</span>
                            </div>
                            <div class="line">
                                <span class="line-number">9</span>
                                <span class="line-content">    <span class="builtin">print</span>(<span class="string">"Cache configurado."</span>)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">10</span>
                                <span class="line-content"><span class="keyword">except</span> <span class="builtin">Exception</span> <span class="keyword">as</span> e:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">11</span>
                                <span class="line-content">    <span class="builtin">print</span>(<span class="string">f"Erro: {str(e)}"</span>)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">12</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">14</span>
                                <span class="line-content"><span class="keyword">try</span>:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">15</span>
                                <span class="line-content">    <span class="keyword">with</span> requests_cache.<span class="function">CachedSession</span>() <span class="keyword">as</span> session:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">16</span>
                                <span class="line-content">         session.headers.<span class="function">update</span>(headers)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">17</span>
                                <span class="line-content">    <span class="builtin">print</span>(<span class="string">"Sess√£o configurada."</span>)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">18</span>
                                <span class="line-content"><span class="keyword">except</span> <span class="builtin">Exception</span> <span class="keyword">as</span> e:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">19</span>
                                <span class="line-content">    <span class="builtin">print</span>(<span class="string">f"Erro: {str(e)}"</span>)</span>
                            </div>
                        </div>
                    </div>

                    <div class="notification" id="notification">Code copied to clipboard!</div>

                    <br><br>
                    <li><strong>Paraleliza√ß√£o</strong> para processar os loops mais rapidamente;</li>
                    <br>
                    <div class="code-container">
                        <div class="code-header">
                            <span>processar_armas.py</span>
                            <button class="copy-button" onclick="copyCode()">Copy</button>
                        </div>
                        <div class="code-content" id="codeContent">
                            <div class="line">
                                <span class="line-number">1</span>
                                <span class="line-content"><span class="comment"># Utilizando a classe Parallel da biblioteca joblib do Python para</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">2</span>
                                <span class="line-content"><span class="comment"># processar a extra√ß√£o dos dados usando 8 n√∫cleos da CPU, preparando cada</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">3</span>
                                <span class="line-content"><span class="comment"># execu√ß√£o (sem executar imediatamente)</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">4</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">5</span>
                                <span class="line-content"><span class="keyword">def</span> <span class="function">processar_armas</span>(urls_itens):</span>
                            </div>
                            <div class="line">
                                <span class="line-number">6</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">7</span>
                                <span class="line-content">    urls_itens = <span class="builtin">list</span>(<span class="builtin">set</span>(urls_itens))</span>
                            </div>
                            <div class="line">
                                <span class="line-number">8</span>
                                <span class="line-content">    resultados = <span class="function">Parallel</span>(n_jobs=<span class="number">8</span>)(<span class="function">delayed</span>(extrair_infos_arma)(url) <span class="keyword">for</span> url <span class="keyword">in</span> urls_itens)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">9</span>
                                <span class="line-content">    <span class="keyword">return</span> [r <span class="keyword">for</span> r <span class="keyword">in</span> resultados <span class="keyword">if</span> r <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">None</span>]</span>
                            </div>
                            <div class="line">
                                <span class="line-number">10</span>
                                <span class="line-content">    </span>
                            </div>
                            <div class="line">
                                <span class="line-number">11</span>
                                <span class="line-content"><span class="comment"># Utilizando a classe ThreadPoolExecutor da biblioteca concurrent.futures</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">12</span>
                                <span class="line-content"><span class="comment"># para criar um pool de 10 threads, onde o executor.submit ir√° enviar</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">13</span>
                                <span class="line-content"><span class="comment"># a fun√ß√£o processar_pagina, com cada URL, para uma thread livre.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">14</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">15</span>
                                <span class="line-content"><span class="comment"># Por exemplo, se houverem 100 URLs, 10 ser√£o processadas imediatamente </span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">16</span>
                                <span class="line-content"><span class="comment"># (1 por thread), e as demais aguardar√£o em uma fila.</span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">17</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">18</span>
                                <span class="line-content"><span class="keyword">with</span> <span class="function">ThreadPoolExecutor</span>(max_workers=<span class="number">10</span>) <span class="keyword">as</span> executor:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">19</span>
                                <span class="line-content">    futures = [executor.<span class="function">submit</span>(processar_pagina, url) <span class="keyword">for</span> url <span class="keyword">in</span> urls_paginas]</span>
                            </div>
                            <div class="line">
                                <span class="line-number">20</span>
                                <span class="line-content">	   </span>
                            </div>
                            <div class="line">
                                <span class="line-number">21</span>
                                <span class="line-content">	  <span class="comment"># Aqui, os resultados s√£o coletados assim que a execu√ß√£o termina </span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">22</span>
                                <span class="line-content">	  <span class="comment"># (m√©todo as_completed).           </span></span>
                            </div>
                            <div class="line">
                                <span class="line-number">23</span>
                                <span class="line-content">    <span class="keyword">for</span> future <span class="keyword">in</span> <span class="function">tqdm</span>(<span class="function">as_completed</span>(futures), total=<span class="builtin">len</span>(futures)):</span>
                            </div>
                            <div class="line">
                                <span class="line-number">24</span>
                                <span class="line-content">        resultado = future.<span class="function">result</span>()</span>
                            </div>
                            <div class="line">
                                <span class="line-number">25</span>
                                <span class="line-content">        <span class="keyword">if</span> resultado:</span>
                            </div>
                            <div class="line">
                                <span class="line-number">26</span>
                                <span class="line-content">            dados_completos.<span class="function">extend</span>(resultado)              </span>
                            </div>
                            <div class="line">
                                <span class="line-number">27</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">28</span>
                                <span class="line-content"></span>
                            </div>
                            <div class="line">
                                <span class="line-number">29</span>
                                <span class="line-content">df = pd.<span class="function">DataFrame</span>(dados_completos)</span>
                            </div>
                            <div class="line">
                                <span class="line-number">30</span>
                                <span class="line-content"><span class="builtin">print</span>(<span class="string">f"Finalizado! {len(df)} itens obtidos."</span>)</span>
                            </div>
                        </div>
                    </div>

                    <div class="notification" id="notification">Code copied to clipboard!</div>
                </ul>
            </p>
        <!-- Recomenda√ß√£o de M√∫sica -->
        <section class="music-section">
        </section>
    </main>

    <footer>
        <p>¬© Juliana Salustiano Vieira</p>
    </footer>

    <script src="/src/script.js"></script>
</body>
</html>